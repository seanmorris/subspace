!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},n={},r={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(e,t){for(var n,r=[],i=(o.test(t)?e+"/"+t:t).split("/"),a=0,s=i.length;a<s;a++)n=i[a],".."===n?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t){return function(n){var r=a(s(t),n);return e.require(r,t)}},c=function(e,t){var r=g&&g.createHot(e),i={id:e,exports:{},hot:r};return n[e]=i,t(i.exports,u(e),i),i.exports},l=function(e){return r[e]?l(r[e]):e},f=function(e,t){return l(a(s(e),t))},h=function(e,r){null==r&&(r="/");var o=l(e);if(i.call(n,o))return n[o].exports;if(i.call(t,o))return c(o,t[o]);throw new Error("Cannot find module '"+e+"' from '"+r+"'")};h.alias=function(e,t){r[t]=e};var p=/\.[^.\/]+$/,v=/\/index(\.[^\/]+)?$/,d=function(e){if(p.test(e)){var t=e.replace(p,"");i.call(r,t)&&r[t].replace(p,"")!==t+"/index"||(r[t]=e)}if(v.test(e)){var n=e.replace(v,"");i.call(r,n)||(r[n]=e)}};h.register=h.define=function(e,r){if(e&&"object"==typeof e)for(var o in e)i.call(e,o)&&h.register(o,e[o]);else t[e]=r,delete n[e],d(e)},h.list=function(){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};var g=e._hmr&&new e._hmr(f,h,t,n);h._cache=n,h.hmr=g&&g.wrap,h.brunch=!0,e.require=h}}(),function(){var t=("undefined"==typeof window?this:window,function(e,t,n){var r={},i=function(t,n){var o;try{return o=e(n+"/node_modules/"+t)}catch(a){if(a.toString().indexOf("Cannot find module")===-1)throw a;if(n.indexOf("node_modules")!==-1){var s=n.split("/"),u=s.lastIndexOf("node_modules"),c=s.slice(0,u).join("/");return i(t,c)}}return r};return function(o){if(o in t&&(o=t[o]),o){if("."!==o[0]&&n){var a=i(o,n);if(a!==r)return a}return e(o)}}});require.register("curvature/base/Bindable.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Bindable=function(){function e(){t(this,e)}return r(e,null,[{key:"isBindable",value:function(t){return!!t.___binding___&&t.___binding___===e}},{key:"makeBindable",value:function(t){if(!t||t.___binding___||"object"!==("undefined"==typeof t?"undefined":n(t))||t instanceof Node)return t;Object.defineProperty(t,"___ref___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"bindTo",{enumerable:!1,writable:!0}),Object.defineProperty(t,"isBound",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___binding___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___bindingAll___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___isBindable___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___executing___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___stack___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___stackTime___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___before___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___after___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___setCount___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___wrapped___",{enumerable:!1,writable:!0}),Object.defineProperty(t,"___object___",{enumerable:!1,writable:!1,value:t}),t.___isBindable___=e,t.___wrapped___={},t.___binding___={},t.___bindingAll___=[],t.___stack___=[],t.___stackTime___=[],t.___before___=[],t.___after___=[],t.___setCount___={},t.bindTo=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!1;e instanceof Function&&(r=n||{},n=e,i=!0);var o=!1;r.delay>=0&&(n=function(e){return function(t,n,i,o){var a=i[n];setTimeout(function(){return e(t,n,i,o,a)},r.delay)}}(n)),r.throttle>=0&&(n=function(e){return function(t,n,i,a){if(!o){var s=i[n];e(t,n,i,a,s),o=!0,setTimeout(function(){return o=!1},r.throttle)}}}(n));var a=void 0;if(r.wait>=0&&(n=function(e){return function(t,n,i,o){a&&clearTimeout(a);var s=i[n];a=setTimeout(function(){return e(t,n,i,o,s)},r.wait)}}(n)),i){var s=t.___bindingAll___.length;t.___bindingAll___.push(n);for(var u in t)n(t[u],u,t,!1);return function(){t.___bindingAll___[s]=null}}t.___binding___[e]||(t.___binding___[e]=[]);var c=t.___binding___[e].length;return t.___binding___[e].push(n),n(t[e],e,t,!1),function(){t.___binding___[e]&&(t.___binding___[e][c]=null)}},t.isBound=function(){for(var e in t.___bindingAll___)if(t.___bindingAll___[e])return!0;for(var n in t.___binding___)for(var r in t.___binding___[n])if(t.___binding___[n][r])return!0;return!1};for(var r in t)t[r]&&"object"==n(t[r])&&!t[r]instanceof Node&&!t[r]instanceof Promise&&(t[r]=e.makeBindable(t[r]));var i=function(r,i,o){if("string"==typeof i&&"___"===i.substring(0,3)&&"___"===i.slice(-3))return!0;if(r[i]===o)return!0;if(o&&"object"==("undefined"==typeof o?"undefined":n(o))&&!(o instanceof Node)&&o.___isBindable___!==e){o=e.makeBindable(o);for(var a in o)o[a]&&"object"==n(o[a])&&(o[a]=e.makeBindable(o[a]))}for(var s in t.___bindingAll___)t.___bindingAll___[s]&&t.___bindingAll___[s](o,i,r,!1);var u=!1;if(i in t.___binding___)for(var c in t.___binding___[i])t.___binding___[i]&&t.___binding___[i][c]&&t.___binding___[i][c](o,i,r,!1,r[i])===!1&&(u=!0);if(!u){var l=Object.getOwnPropertyDescriptor(r,i),f=r instanceof File&&"lastModifiedDate"==i;f||l&&!l.writable||(r[i]=o)}r.___setCount___[i]||(r.___setCount___[i]=0),r.___setCount___[i]++;var h=10;return r.___setCount___[i]>h&&o instanceof Object,Reflect.set(r,i,o)},o=function(e,n){if(!(n in e))return!0;for(var r in t.___bindingAll___)t.___bindingAll___[r](void 0,n,e,!0,e[n]);if(n in t.___binding___)for(var i in t.___binding___[n])t.___binding___[n][i]&&t.___binding___[n][i](void 0,n,e,!0,e[n]);return Array.isArray(e)?e.splice(n,1):delete e[n],!0},a=function(n,r){return n[r]instanceof Function?n.___wrapped___[r]?n.___wrapped___[r]:(n.___wrapped___[r]=function(){n.___executing___=r,n.___stack___.unshift(r);for(var e in n.___before___)n.___before___[e](n,r,t);var i=t instanceof Promise?t:t.___ref___,o=n[r].apply(i,arguments);for(var a in n.___after___)n.___after___[a](n,r,t);return n.___executing___=null,n.___stack___.shift(),o},n.___wrapped___[r]):(n[r]instanceof Object&&e.makeBindable(n[r]),n[r])};return t.___ref___=new Proxy(t,{deleteProperty:o,get:a,set:i}),t.___ref___}},{key:"clearBindings",value:function(e){e.___wrapped___={},e.___bindingAll___=[],e.___binding___={},e.___before___=[],e.___after___=[],e.___ref___={}}},{key:"resolve",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0,i=t.split("."),o=i[0];i.length;){if(n&&1===i.length){var a=this.makeBindable(e);return[a,i.shift(),o]}r=i.shift(),!(!r in e)&&e[r]&&e[r]instanceof Object||(e[r]={}),e=this.makeBindable(e[r])}return[this.makeBindable(e),r,o]}}]),e}()}()}),require.register("curvature/base/Cache.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Cache=function(){function e(){t(this,e)}return n(e,null,[{key:"store",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;n&&(i=1e3*n+(new Date).getTime()),this.bucket||(this.bucket={}),this.bucket[r]||(this.bucket[r]={}),this.bucket[r][e]={expiration:i,value:t}}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard";return this.bucket&&this.bucket[n]&&this.bucket[n][e]&&(0==this.bucket[n][e].expiration||this.bucket[n][e].expiration>(new Date).getTime())?this.bucket[n][e].value:t}}]),e}()}()}),require.register("curvature/base/Cookie.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Cookie=void 0;var r=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n("./Bindable"),a=e.Cookie=function(){function e(){t(this,e)}return i(e,null,[{key:"set",value:function(t,n){e.jar[t]=n}},{key:"get",value:function(t){return e.jar[t]}},{key:"delete",value:function(t){delete e.jar[t]}}]),e}();a.jar=a.jar||o.Bindable.makeBindable({}),"data"!==window.location.href.substr(0,4)&&(document.cookie.split(";").map(function(e){var t=e.split("="),n=r(t,2),i=n[0],o=n[1];try{o=JSON.parse(o)}catch(s){o=o}i=i.trim(),a.jar[decodeURIComponent(i)]=o}),a.jar.bindTo(function(e,t,n,r){n[t]=e,r&&(n[t]=null);var i=encodeURIComponent(t)+"="+n[t];document.cookie=i}))}()}),require.register("curvature/base/Dom.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Dom=function(){function e(){t(this,e)}return n(e,null,[{key:"mapTags",value:function(e,t,n,r,i){var o=[],a=!0;r&&(a=!1);for(var s=!1,u=document.createTreeWalker(e,NodeFilter.SHOW_ALL,{acceptNode:function(e){if(!a){if(e!==r)return NodeFilter.FILTER_SKIP;a=!0}return i&&e===i&&(s=!0),s?NodeFilter.FILTER_SKIP:t?e instanceof Element&&e.matches(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);u.nextNode();)o.push(n(u.currentNode));return o}},{key:"dispatchEvent",value:function(t,n){t.dispatchEvent(n),e.mapTags(t,!1,function(e){e.dispatchEvent(n)})}}]),e}()}()}),require.register("curvature/base/Router.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("./View"),o=(n("./Cache"),n("Config"));e.Router=function(){function e(){t(this,e)}return r(e,null,[{key:"wait",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;r.addEventListener(n,function(){t.listen(e)})}},{key:"listen",value:function(e){var t=this,n=[location.toString()],r=history.length,i=location.pathname+location.search;location.hash&&(i+=location.hash),window.addEventListener("popstate",function(i){i.preventDefault(),n.length&&r==history.length?location.toString()==n[n.length-2]?n.pop():n.push(location.toString()):(n.push(location.toString()),r=history.length),t.match(location.pathname,e)}),this.go(i)}},{key:"go",value:function(e,t){var n=this;document.title=o.Config.title,setTimeout(function(){history.pushState(null,null,e),t||(t===!1&&(n.path=null),window.dispatchEvent(new Event("popstate")),"#"===e.substring(0,1)&&window.dispatchEvent(new HashChangeEvent("hashchange")))},0)}},{key:"match",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==e||r){var o=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{result:b,path:e,view:t}}),a=t.args.content,s=t.routes;this.path=e,this.query={};var u=new URLSearchParams(location.search);this.queryString=location.search;var c=!0,l=!1,f=void 0;try{for(var h,p=u[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;this.query[v[0]]=v[1]}}catch(d){l=!0,f=d}finally{try{!c&&p["return"]&&p["return"]()}finally{if(l)throw f}}var g={},_=!1,b="";e=e.substr(1).split("/");for(var y in this.query)g[y]=this.query[y];e:for(var m in s){var w=m.split("/");if(!(w.length<e.length)){for(var k in w)if("%"==w[k].substr(0,1)){var C=null,T=/^%(\w+)\??/.exec(w[k]);if(T&&T[1]&&(C=T[1]),!C)throw new Error(w[k]+' is not a valid argument segment in route "'+m+'"');if(e[k])g[C]=e[k];else{if("?"!=w[k].substr(w[k].length-1,1))continue e;g[C]=""}}else if(e[k]!==w[k])continue e;if(!r&&a&&s[m]instanceof Object&&a instanceof s[m]&&!(s[m]instanceof Promise)&&a.update(g))return t.args.content=a,!0;_=m,b=s[m];break}}if(document.dispatchEvent(o),_ in s&&s[_]instanceof Object&&s[_].isView&&s[_].isView())b=new s[_](g),b.root=function(){return t};else if(s[_]instanceof Function){b="";var j=s[_](g);j instanceof Promise?(b=!1,j.then(function(r){n.update(t,e,r)})["catch"](function(r){n.update(t,e,r)})):b=j}else s[_]instanceof Promise?(b=!1,s[_].then(function(r){n.update(t,e,r)})["catch"](function(r){n.update(t,e,r)})):s[_]instanceof Object?b=new s[_](g):"string"==typeof s[_]&&(b=s[_]);return this.update(t,e,b),b instanceof i.View&&(b.pause(!1),b.update(g,r)),_!==!1}}},{key:"update",value:function(e,t,n){var r=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:t,view:e}}),o=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:t,view:e}});n!==!1&&(e.args.content instanceof i.View&&e.args.content.remove(),document.dispatchEvent(r)&&(e.args.content=n),document.dispatchEvent(o))}},{key:"clearCache",value:function(){}},{key:"queryOver",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams(location.search),n={},r=[],i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c[0]]=c[1]}}catch(l){o=!0,a=l}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}for(var f in r)n[f]=r[f];for(var h in e)n[h]=e[h];return delete n.api,n}},{key:"queryToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=e;t||(r=this.queryOver(e));for(var i in r)""!==r[i]&&n.push(i+"="+encodeURIComponent(r[i]));return n.join("&")}},{key:"setQuery",value:function(e,t,n){var r={};r[e]=t,this.go(this.path+"?"+this.queryToString(r),n)}}]),e}()}()}),require.register("curvature/base/RuleSet.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.RuleSet=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n("./Dom"),n("./Tag")),o=n("./View");e.RuleSet=function(){function e(){t(this,e)}return r(e,[{key:"add",value:function(e,t){return this.rules=this.rules||{},this.rules[e]=this.rules[e]||[],this.rules[e].push(t),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.apply(t,n);for(var r in this.rules)for(var i in this.rules[r]){var o=this.rules[r][i],a=e.wrap(t,o,n),s=t.querySelectorAll(r),u=!0,c=!1,l=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;a(p)}}catch(v){c=!0,l=v}finally{try{!u&&h["return"]&&h["return"]()}finally{if(c)throw l}}}}}],[{key:"add",value:function(e,t){return this.globalRules=this.globalRules||{},this.globalRules[e]=this.globalRules[e]||[],this.globalRules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in this.globalRules)for(var r in this.globalRules[n]){var i=this.globalRules[n][r],o=this.wrap(e,i,t),a=e.querySelectorAll(n),s=!0,u=!1,c=void 0;try{for(var l,f=a[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;o(h)}}catch(p){u=!0,c=p}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw c}}}}},{key:"wait",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r=function(t,n){return function(){return n.removeEventListener(t,r),e.apply()}}(t,n);n.addEventListener(t,r)}},{key:"wrap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(t instanceof o.View||t&&t.prototype&&t.prototype instanceof o.View)&&(t=function(e){return function(){return e}}(t)),function(e){e.___cvApplied___||(Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!0}),e.___cvApplied___=[]);for(var r in e.___cvApplied___)if(t==e.___cvApplied___[r])return;var a=void 0,s=void 0;n&&(a=s=n,n.viewList&&(s=n.viewList.parent));var u=new i.Tag(e,s,null,(void 0),a),c=u.element.parentNode,l=u.element.nextSibling,f=t(u);if(f!==!1&&e.___cvApplied___.push(t),f instanceof HTMLElement&&(f=new i.Tag(f)),f instanceof i.Tag){if(!f.element.contains(u.element)){for(;u.element.firstChild;)f.element.appendChild(u.element.firstChild);u.remove()}l?c.insertBefore(f.element,l):c.appendChild(f.element)}f&&f.prototype&&f.prototype instanceof o.View&&(f=new f),f instanceof o.View&&(n&&(n.cleanup.push(function(e){return function(){e.remove()}}(f)),f.parent=n,n.cleanup.push(n.args.bindTo(function(e,t,n){n[t]=e,f.args[t]=e})),n.cleanup.push(f.args.bindTo(function(e,t,r,i){r[t]=e,n.args[t]=e}))),u.clear(),f.render(u.element))}}}]),e}()}()}),require.register("curvature/base/Tag.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("./Bindable");e.Tag=function(){function e(n,r,o,a,s){t(this,e),this.element=i.Bindable.makeBindable(n),this.parent=r,this.direct=s,this.ref=o,this.index=a,this.cleanup=[],this.proxy=i.Bindable.makeBindable(this)}return r(e,[{key:"remove",value:function(){i.Bindable.clearBindings(this);for(var e=void 0;e=this.cleanup.shift();)e();if(this.clear(),this.element){var t=new Event("cvDomDetached");this.element.dispatchEvent(t),this.element.remove(),this.element=this.ref=this.parent=null}}},{key:"clear",value:function(){if(this.element)for(var e=new Event("cvDomDetached");this.element.firstChild;)this.element.firstChild.dispatchEvent(e),this.element.removeChild(this.element.firstChild)}},{key:"pause",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}]),e}()}()}),require.register("curvature/base/View.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n("./Bindable"),s=n("./ViewList"),u=n("./Router"),c=(n("./Cookie"),n("./Dom")),l=(n("./Tag"),n("./RuleSet"));e.View=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),Object.defineProperty(this,"___VIEW___",{enumerable:!1,writable:!0}),this.___VIEW___=e,this.args=a.Bindable.makeBindable(t),this._id=this.uuid(),this.args._id=this._id,this.template="",this.document="",this.firstNode=null,this.lastNode=null,this.nodes=null,this.cleanup=[],this.attach=[],this.detach=[],this.eventCleanup=[],this.parent=null,this.viewList=null,this.viewLists={},this.withViews={},this.tags={},this.intervals=[],this.timeouts=[],this.frames=[],this.ruleSet=new l.RuleSet,this.preRuleSet=new l.RuleSet,this.subBindings={},this.removed=!1,this.preserve=!1,this.interpolateRegex=/(\[\[((?:\$)?[\w\.]+)\]\])/g}return o(e,[{key:"onFrame",value:function(e){var t=function n(t){e(t),window.requestAnimationFrame(n)};t()}},{key:"onTimeout",value:function(e,t){var n=this,r=function(){n.timeouts[o].fired=!0,n.timeouts[o].callback=null,t()},i=setTimeout(r,e),o=this.timeouts.length;return this.timeouts.push({timeout:i,callback:r,time:e,fired:!1,created:(new Date).getTime(),paused:!1}),i}},{key:"clearTimeout",value:function(e){for(var t in this.timeouts)e===this.timeouts[t].timeout&&(clearInterval(this.timeouts[t].timeout),delete this.timeouts[t])}},{key:"onInterval",value:function(e,t){var n=setInterval(t,e);return this.intervals.push({timeout:n,callback:t,time:e,paused:!1}),n}},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){for(var t in this.intervals)e===this.intervals[t].timeout&&(clearInterval(this.intervals[t].timeout),delete this.intervals[t])})},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===e&&(this.paused=!this.paused),this.paused=e,this.paused){for(var t in this.timeouts)this.timeouts[t].fired?delete this.timeouts[t]:clearTimeout(this.timeouts[t].timeout);for(var n in this.intervals)clearInterval(this.intervals[n].timeout)}else{for(var r in this.timeouts)this.timeouts[r].timeout.paused&&(this.timeouts[r].fired?delete this.timeouts[r]:this.timeouts[r].timeout=setTimeout(this.timeouts[r].callback,this.timeouts[r].time));for(var i in this.intervals)this.intervals[i].timeout.paused&&(this.intervals[i].timeout.paused=!1,this.intervals[i].timeout=setInterval(this.intervals[i].callback,this.intervals[i].time))}for(var o in this.viewLists){if(!this.viewLists[o])return;this.viewLists[o].pause(!!e)}for(var a in this.tags)if(Array.isArray(this.tags[a]))for(var s in this.tags[a])this.tags[a][s].pause(!!e);else this.tags[a].pause(!!e)}},{key:"render",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof e&&(r=r.firstNode),this.nodes){for(var i in this.detach)this.detach[i]();var o=function(e){var i=new Event("cvDomDetached",{bubbles:!0,target:t.nodes[e]}),o=new Event("cvDomAttached",{bubbles:!0,target:t.nodes[e]});t.nodes[e].dispatchEvent(i),c.Dom.mapTags(t.nodes[e],!1,function(e){e.dispatchEvent(i)}),n&&(r?n.insertBefore(t.nodes[e],r):n.appendChild(t.nodes[e])),c.Dom.mapTags(t.nodes[e],!1,function(e){e.dispatchEvent(o)}),t.nodes[e].dispatchEvent(o)};for(var a in this.nodes)o(a);for(var s in this.attach)this.attach[s]()}else{var u=void 0;this.template==document?u=this.template:this.document?u=this.document:(u=document.createRange().createContextualFragment(this.template),this.document=u),this.preRuleSet.apply(u,this),c.Dom.mapTags(u,!1,function(e){e.matches?(e.matches("[cv-each]")&&t.mapEachTags(e),e.matches("[cv-with]")&&t.mapWithTags(e),e.matches("[cv-prerender]")&&t.mapPrendererTags(e),e.matches("[cv-link]")&&t.mapLinkTags(e),e.matches("[cv-bind]")&&t.mapBindTags(e),e.matches("[cv-attr]")&&t.mapAttrTags(e),t.mapInterpolatableTags(e),e.matches("[cv-expand]")&&t.mapExpandableTags(e),e.matches("[cv-if]")&&t.mapIfTags(e),e.matches("[cv-ref]")&&t.mapRefTags(e),e.matches("[cv-on]")&&t.mapOnTags(e)):t.mapInterpolatableTags(e)}),this.ruleSet.apply(u,this),this.nodes=[],window.devmode===!0?this.firstNode=document.createComment("Template "+this._id+" Start"):this.firstNode=document.createTextNode(""),this.nodes.push(this.firstNode),n&&(r?n.insertBefore(this.firstNode,r):n.appendChild(this.firstNode));for(var l=function(){var e=u.firstChild,i=new Event("cvDomAttached",{bubbles:!0,target:e});t.nodes.push(e),n&&(r?n.insertBefore(e,r):n.appendChild(e)),c.Dom.mapTags(e,!1,function(e){e.dispatchEvent(i)}),e.dispatchEvent(i)};u.firstChild;)l();window.devmode===!0?this.lastNode=document.createComment("Template "+this._id+" End"):this.lastNode=document.createTextNode(""),this.nodes.push(this.lastNode),n&&(r?n.insertBefore(this.lastNode,r):n.appendChild(this.lastNode));for(var f in this.attach)this.attach[f]();this.postRender(n)}}},{key:"mapExpandableTags",value:function(e){var t=this,n=e.getAttribute("cv-expand"),r=a.Bindable.makeBindable(this.args[n]||{});e.removeAttribute("cv-expand");var i=function(n){if("name"==n||"type"==n)return"continue";var i=r.bindTo(n,function(e,t){return function(n){e.setAttribute(t,n)}}(e,n));t.cleanup.push(function(){i(),r.isBound()&&a.Bindable.clearBindings(r)})};for(var o in r){i(o)}}},{key:"mapAttrTags",value:function(e){var t=this,n=e.getAttribute("cv-attr");e.removeAttribute("cv-attr");var r=n.split(","),o=r.map(function(e){return e.split(":")}),s=function(n){var r=t.args,s=o[n][1],u=s;if(s.match(/\./)){var c=a.Bindable.resolve(t.args,s,!0),l=i(c,2);r=l[0],u=l[1]}r[o[n][1]]&&e.setAttribute(o[n][0],r[o[n][1]]);var f=o[n][0];t.cleanup.push(r.bindTo(u,function(t){return null==t?void e.setAttribute(f,""):void e.setAttribute(f,t)}))};for(var u in o)s(u)}},{key:"mapInterpolatableTags",value:function(t){var n=this,r=this.interpolateRegex;if(t.nodeType==Node.TEXT_NODE){var o=t.nodeValue;if(!this.interpolatable(o))return;for(var s=0,u=void 0,c=function(){var r=u[2],c=!1;if("$"===r.substr(0,1)&&(c=!0,r=r.substr(1)),"000"===r.substr(0,3))return expand=!0,r=r.substr(3),"continue";var l=o.substring(s,u.index);s=u.index+u[1].length;var f=document.createTextNode(l);t.parentNode.insertBefore(f,t);var h=void 0;h=c?document.createElement("div"):document.createTextNode("");var p=n.args,v=r;if(r.match(/\./)){var d=a.Bindable.resolve(n.args,r,!0),g=i(d,2);p=g[0],v=g[1]}t.parentNode.insertBefore(h,t);var _=p.bindTo(v,function(r,i){return function(o,a,s){s[a]instanceof e&&s[a]!==o&&(s[a].preserve||s[a].remove()),r.nodeValue="",o instanceof e?(o.render(t.parentNode,r),n.cleanup.push(function(){o.preserve||o.remove()})):(o instanceof Object&&o.__toString instanceof Function&&(o=o.__toString()),i?r.innerHTML=o:r.nodeValue=o)}}(h,c));n.cleanup.push(function(){_(),p.isBound()||a.Bindable.clearBindings(p)})};u=r.exec(o);){c()}var l=o.substring(s),f=document.createTextNode(l);t.parentNode.insertBefore(f,t),t.nodeValue=""}if(t.nodeType==Node.ELEMENT_NODE)for(var h=function(e){if(!n.interpolatable(t.attributes[e].value))return"continue";for(var o=0,s=void 0,u=t.attributes[e].value,c=t.attributes[e],l={},f=[];s=r.exec(u);)f.push(u.substring(o,s.index)),l[s[2]]||(l[s[2]]=[]),l[s[2]].push(f.length),f.push(s[1]),o=s.index+s[1].length;f.push(u.substring(o));var h=function(e){var r=n.args,o=e;if(e.match(/\./)){var s=a.Bindable.resolve(n.args,e,!0),u=i(s,2);r=u[0],o=u[1]}var h=e,p=r.bindTo(o,function(e,n,r,i){for(var a in l)for(var s in l[h])f[l[h][s]]=r[a],n===o&&(f[l[h][s]]=e);t.setAttribute(c.name,f.join(""))});n.cleanup.push(function(){p(),r.isBound()||a.Bindable.clearBindings(r)})};for(var p in l)h(p)},p=0;p<t.attributes.length;p++){h(p)}}},{key:"mapRefTags",value:function(e){var t=e.getAttribute("cv-ref"),n=t.split(":"),r=i(n,3),o=r[0],a=r[1],s=r[2],u=this.stringToClass(a);e.removeAttribute("cv-ref"),Object.defineProperty(e,"___tag___",{enumerable:!1,writable:!0}),this.cleanup.push(function(){e.___tag___=null,e.remove()});var c=this,l=this;this.viewList&&(c=this.viewList.parent);var f=new u(e,this,o,(void 0),l);for(e.___tag___=f;c;){!c.parent;var h=this.args[s];void 0!==h?(c.tags[o]||(c.tags[o]=[]),c.tags[o][h]=f):c.tags[o]=f,c=c.parent}}},{key:"mapBindTags",value:function(t){var n=this,r=t.getAttribute("cv-bind"),o=this.args,s=r,u=null;if(r.match(/\./)){var c=a.Bindable.resolve(this.args,r,!0),l=i(c,3);o=l[0],s=l[1],u=l[2]}o!==this.args&&(this.subBindings[r]=this.subBindings[r]||[],this.cleanup.push(this.args.bindTo(u,function(){for(;n.subBindings.length;)console.log("HERE!"),n.subBindings.shift()()})));var f=o.bindTo(s,function(n,r,i,o,a){if(a instanceof e&&a!==n&&a.remove(),"INPUT"!=t.tagName&&"SELECT"!=t.tagName&&"TEXTAREA"!=t.tagName)n instanceof e?n.render(t):t.innerText=n;else{var s=t.getAttribute("type");if(s&&"checkbox"==s.toLowerCase())t.checked=!!n;else if(s&&"radio"==s.toLowerCase())t.checked=n==t.value;else if("file"!==s){if("SELECT"==t.tagName)for(var u in t.options){var c=t.options[u];c.value==n&&(t.selectedIndex=u)}t.value=null==n?"":n}}});o!==this.args&&this.subBindings[r].push(f),this.cleanup.push(f);var h=function(e){if(e.target===t){var n=t.getAttribute("type"),r=t.getAttribute("multiple");n&&"checkbox"==n.toLowerCase()?t.checked?o[s]=e.target.value:o[s]=!1:"file"!==n?o[s]=e.target.value:"file"==n&&r&&(o[s]=Array.from(e.target.files))}};t.addEventListener("input",h),t.addEventListener("change",h),t.addEventListener("value-changed",h),this.cleanup.push(function(e,t){return function(){e.removeEventListener("input",h),e.removeEventListener("change",h),e.removeEventListener("value-changed",h),e=void 0,t=void 0}}(t,h)),t.removeAttribute("cv-bind")}},{key:"mapOnTags",value:function(e){var n=this;String(e.getAttribute("cv-on")).split(/;/).map(function(e){return e.split(":")}).map(function(e,r){return function(i){var o=i[0].replace(/(^[\s\n]+|[\s\n]+$)/,""),a=i[1],s=[],u=/(\w+)(?:\(([$\w\s'",]+)\))?/.exec(a);u.length&&(a=u[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),u[2]&&(s=u[2].split(",").map(function(e){return e.trim()})));for(var c=void 0,l=n;l;){if("function"==typeof l[a]){var f=function(){var e=l,t=a;return c=function(){e[t].apply(e,arguments)},"break"}();if("break"===f)break}if(l.viewList&&l.viewList.parent)l=l.viewList.parent;else{if(!l.parent)break;l=l.parent}}var h=function(e,r,i,o){return function(e){var u=s.map(function(t){var i=void 0;return parseInt(t)==t?t:"event"===t||"$event"===t?e:"$view"===t?r:"$tag"===t?o:"$parent"===t?n.parent:"$subview"===t?n:t in n.args?n.args[t]:(i=/^['"](\w+?)["']$/.exec(t))?i[1]:void 0});if("function"!=typeof i)throw new Error(a+" is not defined on View object.\n\nTag:\n\n"+o.outerHTML);i.apply(void 0,t(u))}}(e,l,c,r);switch(o){case"_init":h();break;case"_attach":n.attach.push(h);
break;case"_detach":n.detach.push(h);break;default:r.addEventListener(o,h),n.cleanup.push(function(){r.removeEventListener(o,h)})}return[o,a,s]}}(this,e));e.removeAttribute("cv-on")}},{key:"mapLinkTags",value:function(e){var t=e.getAttribute("cv-link");e.setAttribute("href",t);var n=function(n){return n.preventDefault(),"http"==t.substring(0,4)||"//"==t.substring(0,2)?void window.open(e.getAttribute("href",t)):void u.Router.go(e.getAttribute("href"))};e.addEventListener("click",n),this.cleanup.push(function(e,t){return function(){e.removeEventListener("click",t),e=void 0,t=void 0}}(e,n)),e.removeAttribute("cv-link")}},{key:"mapPrendererTags",value:function(e){var t=e.getAttribute("cv-prerender"),n=window.prerenderer;("never"==t&&n||"only"==t&&!n)&&e.parentNode.removeChild(e)}},{key:"mapWithTags",value:function(t){var n=this,r=t.getAttribute("cv-with"),i=t.getAttribute("cv-carry");t.removeAttribute("cv-with"),t.removeAttribute("cv-carry");var o=t.innerHTML,s=[];i&&(s=i.split(",").map(function(e){return e.trim()}));var u=this.args.bindTo(r,function(r,i,u,c){for(n.withViews[i]&&n.withViews[i].remove();t.firstChild;)t.removeChild(t.firstChild);var l=new e;n.cleanup.push(function(e){return function(){e.remove()}}(l)),l.template=o,l.parent=n;var f=function(e){var t=n.args.bindTo(s[e],function(e,t){l.args[t]=e});l.cleanup.push(t),n.cleanup.push(function(){t(),l.remove()})};for(var h in s)f(h);var p=function(e){var t=r.bindTo(e,function(e,t){l.args[t]=e});n.cleanup.push(function(){t(),r.isBound()||a.Bindable.clearBindings(r),l.remove()}),l.cleanup.push(function(){t(),r.isBound()||a.Bindable.clearBindings(r)})};for(var h in r)p(h);l.render(t),n.withViews[i]=l});this.cleanup.push(u)}},{key:"mapEachTags",value:function(t){var n=this,r=t.getAttribute("cv-each");t.removeAttribute("cv-each");for(var o=t.innerHTML;t.firstChild;)t.removeChild(t.firstChild);var a=r.split(":"),u=i(a,3),c=u[0],l=u[1],f=u[2],h=this.args.bindTo(c,function(r,i,a,u,h){n.viewLists[c]&&n.viewLists[c].remove();var p=new s.ViewList(o,l,r,n,f);n.cleanup.push(function(){p.remove()});var v=n.args.bindTo(function(e,t,n,r){"_id"!=t&&p.args.subArgs[t]!==e&&(p.args.subArgs[t]=e)});for(var d in n.args)"_id"!=d&&(p.args.subArgs[i]=n.args[d]);var g=p.args.bindTo(function(t,r,i,o,a){if("_id"!=r&&"___"!==r.substring(0,3)){var s=t,u=a;t instanceof e&&(s=t.___ref___),a instanceof e&&(u=a.___ref___),s!==u&&i[r]instanceof e&&i[r].remove(),r in n.args&&s!==u&&(n.args[r]=t)}},{wait:0});for(n.cleanup.push(function(){v(),g()});t.firstChild;)t.removeChild(t.firstChild);n.viewLists[c]=p,p.render(t)});this.cleanup.push(function(){h()})}},{key:"mapIfTags",value:function(t){var n=t.getAttribute("cv-if");t.removeAttribute("cv-if");var r=t.innerHTML,o=!1;for("!"===n.substr(0,1)&&(o=!0,n=n.substr(1));t.firstChild;)t.removeChild(t.firstChild);var s=document.createRange().createContextualFragment(""),u=new e;u.template=r,u.parent=this;for(var c=this.syncBind(u),l=this;l.parent;)l=l.parent;this.cleanup.push(function(){c()}),u.render(t);var f=this.args,h=n;if(n.match(/\./)){var p=a.Bindable.resolve(this.args,n,!0),v=i(p,2);f=v[0],h=v[1]}var d=f.bindTo(h,function(e,n){if(Array.isArray(e)&&(e=!!e.length),o&&(e=!e),e)u.render(t);else{for(;t.firstChild;)t.firstChild.remove();u.render(s)}});this.cleanup.push(function(){d(),f.isBound()||a.Bindable.clearBindings(f)})}},{key:"syncBind",value:function(t){var n=this,r=this.args.bindTo(function(e,n,r,i){"_id"!=n&&t.args[n]!==e&&(t.args[n]=e)});for(var i in this.args)"_id"!=i&&(t.args[i]=this.args[i]);var o=t.args.bindTo(function(t,r,i,o,a){if("_id"!=r){var s=t,u=a;t instanceof e&&(s=t.___ref___),a instanceof e&&(u=a.___ref___),s!==u&&a instanceof e&&a.remove(),r in n.args&&s!==u&&(n.args[r]=t)}},{wait:0});return function(){r(),o()}}},{key:"postRender",value:function(e){}},{key:"interpolatable",value:function(e){return!!String(e).match(this.interpolateRegex)}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"remove",value:function(){var e=new Event("cvDomDetached");for(var t in this.tags)if(Array.isArray(this.tags[t]))for(var n in this.tags[t])this.tags[t][n].remove();else this.tags[t].remove();for(var r in this.nodes)this.nodes[r].dispatchEvent(e),this.nodes[r].remove();for(var i=void 0;i=this.cleanup.shift();)i();for(var o in this.viewLists)this.viewLists[o]&&this.viewLists[o].remove();this.viewLists=[];for(var a in this.timeouts)clearInterval(this.timeouts[a].timeout),delete this.timeouts[a];for(var s in this.intervals)clearInterval(this.intervals[s].timeout),delete this.intervals[s];this.removed=!0}},{key:"findTag",value:function(e){for(var t in this.nodes){var n=void 0;if(this.nodes[t].querySelector){if(this.nodes[t].matches(e))return this.nodes[t];if(n=this.nodes[t].querySelector(e))return n}}}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"stringToClass",value:function(e){var t=e.split("/"),r=t[t.length-1],i=n(e);return i[r]}}],[{key:"isView",value:function(){return e}}]),e}()}()}),require.register("curvature/base/ViewList.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewList=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("./Bindable"),o=n("./View"),a=function(){function e(n,r,o,a){var s=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;t(this,e),this.args=i.Bindable.makeBindable({}),this.args.value=i.Bindable.makeBindable(o||{}),this.args.subArgs=i.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.template=n,this.subProperty=r,this.keyProperty=u,this.tag=null,this.paused=!1,this.parent=a,this.args.value.___before___.push(function(e){"bindTo"!=e.___executing___&&(s.paused=!0)}),this.args.value.___after___.push(function(e){"bindTo"!=e.___executing___&&(s.paused=e.___stack___.length>1,s.reRender())});var c=this.args.value.bindTo(function(e,t,n,r){if(!s.paused)if(r){s.views[t]&&s.views[t].remove(),s.views.splice(t,1);for(var i in s.views)s.views[i].args[s.keyProperty]=i}else s.views[t]||s.reRender()},{wait:0});this.cleanup.push(c)}return r(e,[{key:"render",value:function(e){for(var t in this.views)this.views[t].render(e);this.tag=e}},{key:"reRender",value:function(){var e=this;if(!this.paused&&this.tag){var t=[];for(var n in this.views)t[n]=this.views[n];var r=[];for(var i in this.args.value){var a=!1;for(var s in t)if(t[s]&&this.args.value[i]&&this.args.value[i]===t[s].args[this.subProperty]){a=!0,r[i]=t[s],r[i].args[this.keyProperty]=i,delete t[s];break}a||!function(){var t={};r[i]=new o.View(t);r[i].template=e.template,r[i].parent=e.parent,r[i].viewList=e,r[i].args[e.keyProperty]=i,r[i].args[e.subProperty]=e.args.value[i],e.cleanup.push(e.args.value.bindTo(i,function(e,t,n){})),e.cleanup.push(t.bindTo(e.subProperty,function(n,r){var i=t[e.keyProperty];e.args.value[i]=n})),e.cleanup.push(e.args.subArgs.bindTo(function(e,n,r,i){t[n]=e})),t[e.subProperty]=e.args.value[i]}()}for(var u in t){var c=!1;for(var l in r)if(t[u]===r[l]){c=!0;break}c||t[u].remove()}var f=!0;for(var h in this.views)this.views[h]!==r[h]&&(f=!1);for(var p in r)r[p]!==this.views[p]&&(t.splice(p+1,0,r[p]),r[p].render(this.tag));for(var v in r)r[v].args[this.keyProperty]=v;this.views=r}}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var t in this.views)this.views[t].pause(e)}},{key:"remove",value:function(){for(var e in this.views)this.views[e].remove();for(var t=void 0;this.cleanup.length;)(t=this.cleanup.pop())();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);i.Bindable.clearBindings(this.args.subArgs),i.Bindable.clearBindings(this.args),this.args.value.isBound()||i.Bindable.clearBindings(this.args.value)}}]),e}();e.ViewList=a}()}),require.register("curvature/input/Keyboard.js",function(e,n,r){n=t(n,{},"curvature"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("../base/Bindable");e.Keyboard=function(){function e(){var n=this;t(this,e),this.maxDecay=120,this.listening=!0,this.keys=i.Bindable.makeBindable({}),this.codes=i.Bindable.makeBindable({}),document.addEventListener("keyup",function(e){n.keys[e.key]=-1,n.codes[e.code]=-1}),document.addEventListener("keydown",function(e){n.keys[e.key]>0||(n.keys[e.key]=1,n.codes[e.code]=1)}),window.addEventListener("blur",function(e){for(var t in n.keys)n.keys[t]=-1;for(var r in n.codes)n.codes[r]=-1})}return r(e,[{key:"getKey",value:function(e){return this.keys[e]?this.keys[e]:0}},{key:"getKeyCode",value:function(e){return this.codes[e]?this.codes[e]:0}},{key:"update",value:function(){for(var e in this.keys)this.keys[e]>0?this.keys[e]++:(this.keys[e]--,this.keys[e]<-this.maxDecay&&delete this.keys[e]);for(var e in this.codes)this.codes[e]>0?this.codes[e]++:(this.codes[e]--,this.codes[e]<-this.maxDecay&&delete this.keys[e])}}]),e}()}()}),require.register("subspace-client/Channel.js",function(e,n,r){n=t(n,{},"subspace-client"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Channel=function(){function e(){t(this,e)}return n(e,null,[{key:"scalar",value:function(e,t){var n=new Uint8Array(e).buffer;return"float"==t?new Float64Array(n)[0]:"Int32"==t?new Int32Array(n)[0]:void 0}},{key:"namePart",value:function(e,t){return e.split(":")[t]||null}},{key:"isWildcard",value:function(e){return/\*/.exec(e)}},{key:"isRange",value:function(e){}},{key:"containsRange",value:function(e){}},{key:"compareNames",value:function(e,t){var n=/^(\d+)\-?(\d+)?$/,r=[],i=e.toString().split(":"),o=t.toString().split(":"),a=i.length,s=void 0,u=void 0;a<o.length&&(a=o.length);for(var c=0;c<a;c++){if(i.length>c)s=i[c];else{if("*"!=i[i.length-1])return!1;s=i[i.length-1]}if(o.length>c)u=o[c];else{if("*"!=o[o.length-1])return!1;u=o[o.length-1]}var l="*"!==s?s:u;if(s!==u&&"*"!==s&&"*"!==u){var f=n.exec(s),h=n.exec(u);if(!f||!h)return!1;var p=f[1],v=f[1],d=h[1],g=h[1];if(f[2]&&(v=f[2]),h[2]&&(g=h[2]),p>=d&&v<=g?l=p+"-"+v:p<=d&&v>g?l=d+"-"+g:v<=g&&v>=d?l=d+"-"+v:p<=g&&p>=d&&(l=p+"-"+g),g<=v&&g>=p)l=p+"-"+g;else{if(!(d<=v&&d>=p))return!1;l=d+"-"+v}}r.push(l)}return r.join(":")}}]),e}()}()}),require.register("subspace-client/Socket.js",function(e,n,r){n=t(n,{},"subspace-client"),function(){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n("./Channel");e.Socket=function(){function e(n){t(this,e),this.socket=n,n.binaryType="arraybuffer",this.data={},this.listenerCount={},this.openQueue=[],this._onSend=[]}return i(e,null,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.sockets||(this.sockets={}),!t&&this.sockets[e]||(this.sockets[e]=new this(new WebSocket(e))),this.sockets[e]}}]),i(e,[{key:"subscribe",value:function(e,t,n){var i=e.split(":"),a=i.shift(),s=i.join(":");t instanceof Function&&(n=t,t=s),s&&(s in this.listenerCount||(this.listenerCount[s]=0),this.listenerCount[s]++,this.send("sub "+s));var u=function(e,t,n,i){return function(a){var s={};try{if("string"==typeof a.data)s=JSON.parse(a.data);else if(a.data instanceof ArrayBuffer){var u=new Uint16Array(a.data,4,1)[0];if(!t||o.Channel.compareNames(t,u))return void i(a,a.data.slice(6),u,new Uint16Array(a.data,0,1)[0]?"user":"server",new Uint16Array(a.data,2,1)[0],null,{})}else if("message"!==e)return void i(a)}catch(c){return void("message"!==e&&i(a))}return"object"!==("undefined"==typeof s?"undefined":r(s))?void(""===n&&i(a,a.data,null,"server",0,null,s)):(t||i(a,s.message,null,s.origin,s.originId,null,s),void(t&&"channel"in s&&o.Channel.compareNames(t,s.channel)&&i(a,s.message,s.channel,s.origin,s.originId,s.originalChannel,s)))}}(a,t,s,n);return this.socket.addEventListener(a,u),u}},{key:"unsubscribe",value:function(e,t){var n=e.split(":"),r=n.shift(),i=n.join(":");i&&(this.listenerCount[i]--,i in this.listenerCount&&this.listenerCount[i]>0||(this.socket.removeEventListener(r,t),this.send("unsub "+i)))}},{key:"publish",value:function(e,t){if(e==parseInt(e)){t instanceof ArrayBuffer?t=new Uint8Array(t):t.byteLength?t=new Uint8Array(t.buffer):Array.isArray(t)||(t=[t]);var n=new Uint8Array(new Uint16Array([e]).buffer),r=new Uint8Array(n.byteLength+t.byteLength);return r.set(n,0),r.set(t,n.byteLength),void this.send(r)}this.send("pub "+e+" "+t)}},{key:"send",value:function(e){var t=this;if(this.socket.readyState!==this.socket.OPEN)return new Promise(function(n,r){var i=function(e){return function(r){for(;t.openQueue.length;){var i=t.openQueue.shift();t.send(i)}t.socket.removeEventListener("open",e),n()}}(i);t.socket.addEventListener("open",i),t.openQueue.unshift(e)});for(var n in this._onSend)this._onSend[n](e);return this.socket.send(e),Promise.resolve()}},{key:"onSend",value:function(e){this._onSend.push(e)}},{key:"close",value:function(e){this.socket.close()}},{key:"ping",value:function(){}},{key:"pong",value:function(){}}]),e}()}()}),require.register("BinaryMessageView.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.BinaryMessageView=void 0;var a=t("curvature/base/View");e.BinaryMessageView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.template="<span>&gt;&gt;&nbsp;0x</span>[[header]]&nbsp;[[message]]",n}return o(t,e),t}(a.View)}),require.register("ByteView.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.ByteView=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t("curvature/base/View");e.ByteView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.args.separator=n.args.separator||"",n.template='<span\n\t\t\tcv-each = "bytes:byte:b"\n\t\t\tcv-carry = "separator"\n\t\t\tstyle = "display: block;"\n\t\t\t"><span\n\t\t\t\tcv-on = "cvDomAttached:color(event, byte, $view)"\n\t\t\t\tcv-ref = "byte:curvature/base/Tag"\n\t\t\t\t\n\t\t\t>[[byte]][[separator]]</span></span>',n}return o(t,e),a(t,[{key:"color",value:function n(e,t,r){var i=parseInt(t,16);if(i){var n="hsl("+360*i/255+",70%,70%)";r.tags["byte"].element.style.color=n,r.tags["byte"].element.style["text-shadow"]="2px 0px 5px "+n+", -2px 0px 5px "+n}}}]),t}(s.View)}),require.register("Config.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=e.Config=function o(){r(this,o)};i.title="SubSpace 0.2.0a",i.socketHost="ws://"+location.hostname+":9998"}),require.register("Cornfield.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Cornfield=function(){function e(t){var n=this;r(this,e),t.args.output.push(":: Welcome to Cornfield"),t.args.output.push(":: You are in a cornfield."),t.args.output.push(":: You see corn."),t.args.output.push(":: Move? [north south east west]"),t.args.output.push(":: Look?"),t.localEcho=!1,this.socket=t.socket,this.socket.subscribe("message:cornfield:game",function(e,t,n,r){}),this.socket.subscribe("message:cornfield:chat",function(e,n,r,i,o){t.args.output.push("!! <"+o+"> "+n)}),this.socket.subscribe("message:cornfield:users:ping",function(e,t,r,i){n.socket.publish("cornfield:users:pong","pong!")}),this.socket.subscribe("message:cornfield:users:pong",function(e,t,n,r){})}return i(e,[{key:"pass",value:function(e,t){var n=e.split(" "),r=n.shift();switch(console.log(r),r.toLowerCase()){case"ping":this.socket.publish("cornfield:users:ping","ping!");break;case"look":t.args.output.push(":: You found an ear of corn."),this.socket.publish("cornfield:game","l");break;case"n":case"north":t.args.output.push(":: You moved north."),this.socket.publish("cornfield:game","n");break;case"s":case"south":t.args.output.push(":: You moved south."),this.socket.publish("cornfield:game","s");break;case"e":case"east":t.args.output.push(":: You moved east."),this.socket.publish("cornfield:game","e");break;case"w":case"west":t.args.output.push(":: You moved west."),this.socket.publish("cornfield:game","w");break;case"t":case"talk":case"say":var i=n.join(" ");t.args.output.push("!! <you> "+i),this.socket.publish("cornfield:chat",i)}t.args.input=""}}]),e}()}),require.register("Image.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("curvature/base/View");e.Image=function(){function e(t,n){r(this,e),t.localEcho=!1,this.socket=t.socket;var i=0;n.length&&(i=n[0]),this.socket.subscribe("message:"+i,function(e,n,r,i){console.log(n,r,i),t.args.output.push("Got one.");var a=new Blob([new Uint8Array(n)]),s=URL.createObjectURL(a),u=new o.View;u.template='<img cv-attr = "src:img" cv-ref = "img:curvature/base/Tag" />',u.postRender=function(){var e=u.tags.img.element,t=function n(t){e.removeEventListener("load",n),URL.revokeObjectURL(s)};e.addEventListener("load",t)},t.args.output.push(u),u.args.img=s}),t.args.output.push(":: Listening for images on channel "+i)}return i(e,[{key:"pass",value:function(e,t){var n=e.split(" "),r=n.shift();switch(console.log(r),r.toLowerCase()){case"ping":this.socket.publish("cornfield:users:ping","ping!")}t.args.input=""}}]),e}()}),require.register("Login.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Login=function(){function e(){r(this,e)}return i(e,[{key:"init",value:function(e){e.args.output.push(":: Please type your username")}},{key:"pass",value:function(e,t){return t.args.passwordMode=!1,this.stack||(this.stack=[]),this.stack.push(e),1==this.stack.length?(t.args.passwordMode=!0,t.args.input="",void t.args.output.push(":: Please type your password [censored]")):void(2==this.stack.length&&(t.args.input="",t.localLock=!1,t.args.prompt="<<",t.args.output.push("<< login "+this.stack[0]+" [password censored]"),t.socket.send("login "+this.stack[0]+" "+this.stack[1]),t.args.output.push(":: Checking...")))}}]),e}()}),require.register("MeltingText.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.MeltingText=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t("curvature/base/View");e.MeltingText=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.charUp=["","","","","","","","","","","","","","","","","","","","","","","","","","","",""],n.charMid=["","","","","","","","","","","","","","","","","","","","",""],n.charDown=["","","","","","","","","","","","","","","","","","","",""],n.template='\n\t\t\t<div cv-bind = "output" class = "melting"></div>\n\t\t',n.args.input="Magic is no more than the art of employing consciously invisible means to produce visible effects. Will, love, and imagination are magic powers that everyone possesses; and whoever knows how to develop them to their fullest extent is a magician. Magic has but one dogma, namely, that the seen is the measure of the unseen\n",n.args.output="uh.",n.corruptors={},n.maxCorrupt=20,n.type="",n.args.bindTo("type",function(e){n.output=n.corrupt(n.type)}),setInterval(function(){n.typewriter(n.args.input)},25),setInterval(function(){var e=window.getSelection();e.anchorOffset===e.focusOffset&&e.anchorNode===e.focusNode&&(n.args.output=n.corrupt(n.type))},35),n.args.bindTo("input",function(e){n.type="",n.corruptors=[]}),n}return o(t,e),a(t,[{key:"corrupt",value:function(e){var t=e.split(""),n=function(e){return parseInt(Math.random()*e)};for(var r in t)if(this.corruptors[r]||(this.corruptors[r]=[]),!t[r].match(/\W/)){for(var i=[this.charDown,this.charDown,this.charUp,this.charMid],o=i[n(i.length)];this.corruptors[r].length<this.maxCorrupt;){if(n(5)<1){this.corruptors[r].unshift(this.corruptors[r].pop());break}o===this.charMid&&n(15)>9&&this.corruptors[r].shift(),this.corruptors[r].unshift(o[n(o.length)])}this.corruptors[r].length>=this.maxCorrupt&&this.corruptors[r].pop(),t[r]+=this.corruptors[r].join("")}return t.join("")}},{key:"typewriter",value:function(e){return this.type=this.type||"",this.type===e||(this.type+=e.substr(this.type.length,1),this.onTimeout(150,function(){document.body.scrollHeight>window.scrollY+window.innerHeight&&window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}),!1)}}]),t}(s.View)}),require.register("Register.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();e.Register=function(){function e(){r(this,e)}return i(e,[{key:"init",value:function(e){e.args.output.push(":: Please type your username")}},{key:"pass",value:function(e,t){if(t.args.passwordMode=!1,this.stack||(this.stack=[]),this.stack.push(e),1==this.stack.length)return t.args.input="",void t.args.output.push(":: Please type your email address");if(2==this.stack.length)return t.args.passwordMode=!0,t.args.input="",void t.args.output.push(":: Please type your password");if(3==this.stack.length)return t.args.passwordMode=!0,t.args.input="",void t.args.output.push(":: Please type your password again.");if(4==this.stack.length){if(t.args.input="",this.stack[2]!==this.stack[3])return t.args.output.push(":: Password verification failed."),t.args.output.push(":: Please type your password"),t.args.passwordMode=!0,this.stack.pop(),void this.stack.pop();t.args.output.push(":: Trying to register "+this.stack[0]+" <"+this.stack[1]+">..."),t.args.output.push("<< register "+this.stack[0]+" [password censored] "+this.stack[1]),t.socket.send("register "+this.stack[0]+" "+this.stack[2]+" "+this.stack[1]),t.localLock=!1,t.args.prompt="<<"}}}]),e}()}),require.register("RootView.js",function(t,n,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RootView=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n("Config"),l=n("curvature/base/View"),f=n("curvature/input/Keyboard"),h=n("subspace-client/Socket"),p=n("BinaryMessageView"),v=n("TextMessageView"),d=n("ByteView"),g=n("MeltingText"),_=n("Login"),b=n("Register"),y=n("Cornfield"),m=(n("chat/Chat"),n("Image"));t.RootView=function(t){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,r);var a=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));a.routes={},a.template=n("./root.tmp"),a.args.input="",a.args.output=[],a.args.inverted="",a.args.passwordMode=!1,a.localEcho=!0,a.localLock=null,a.args.prompt="<<",a.max=1024,a.history=[],a.historyCursor=-1,t.output.___after___.push(function(e,t,n,r){"push"===t&&(a.onTimeout(16,function(){window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}),a.onTimeout(48,function(){window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}))}),a.runScript("/init_rc");var s=new f.Keyboard;s.keys.bindTo(function(e,t){},{wait:1}),s.keys.bindTo("Escape",function(e){1==e&&(a.localLock&&a.args.output.push(":: Killed."),a.localLock=!1,a.args.prompt="<<",a.args.passwordMode=!1)},{wait:1}),s.keys.bindTo("ArrowUp",function(e){if(1==e){if(a.historyCursor++,a.historyCursor>=a.history.length)return void a.historyCursor--;a.args.input=a.history[a.historyCursor]}},{wait:1}),s.keys.bindTo("ArrowDown",function(e){if(1==e){if(a.historyCursor--,a.historyCursor<=-1)return a.historyCursor++,void(a.args.input="");a.args.input=a.history[a.historyCursor]}},{wait:1});var u={iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]};return a.peerClient=new RTCPeerConnection(u),a.peerServer=new RTCPeerConnection(u),a.peerClient.addEventListener("icecandidate",function(e){console.log(e.candidate);var t=JSON.stringify(a.peerClient.localDescription,null,4);a.args.output.push(":: Client description"),a.args.output.push(t)}),a.peerServer.addEventListener("icecandidate",function(){var e=JSON.stringify(a.peerServer.localDescription,null,4);a.args.output.push(":: Server description"),a.args.output.push(e)}),a.peerClient.addEventListener("iceconnectionstatechange",function(){var e=a.peerClient.iceConnectionState;a.args.output.push(":: Peer client state "+e+".")}),a.peerServer.addEventListener("iceconnectionstatechange",function(){var e=a.peerClient.iceConnectionState;a.args.output.push(":: Peer server state "+e+".")}),a.peerServer.addEventListener("datachannel",function(){var t=a.peerClient.iceConnectionState;a.args.output.push(":: Peer server state "+t+"."),a.peerServerChannel=e.channel,a.peerClientChannel.addEventListener("open",function(){console.log("Remote peer server accepted!")}),a.peerClientChannel.addEventListener("message",function(e){console.log("Remote peer server sent message!"),console.log(e)})}),a}return a(r,t),u(r,[{key:"runScript",value:function(e){var t=this;fetch(e+"?api=txt").then(function(e){return e.text()}).then(function(e){var n=e.split("\n");for(var r in n){var i=n[r];if("!"==i[0])t.args.output.push(i.substring(1));else{if(!i)continue;t.interpret(i)}}})}},{key:"postRender",value:function(){var e=this;this.args.bindTo("passwordMode",function(t){t?(e.tags.input.element.style.display="none",e.tags.password.element.style.display="unset"):(e.tags.input.element.style.display="unset",e.tags.password.element.style.display="none"),e.focus()},{wait:0})}},{key:"fileLoaded",value:function(e){var t=this;if(this.fileChannel!==!1){var n=new FileReader,r=e.target,i=e.target.files[0];n.addEventListener("load",function(e){t.args.output.push(":: Sending "+i.name+"..."),t.fileChannel==parseInt(t.fileChannel)?t.socket.publish(t.fileChannel,e.target.result):(console.log(e.target),t.socket.publish(t.fileChannel,new TextDecoder("utf-8").decode(e.target.result))),t.fileChannel=!1,r.value=""}),n.readAsArrayBuffer(i)}}},{key:"focus",value:function(e){if(!(e&&"INPUT"==e.target.name||window.getSelection().toString()))return this.args.passwordMode?void this.tags.password.element.focus():void this.tags.input.element.focus();
}},{key:"submit",value:function(e){this.interpret(this.args.input)}},{key:"interpret",value:function(e){var t=this;if(this.localLock)return"/quit"==e?(this.localLock=!1,this.args.prompt="<<",this.args.output.push(":: Killed."),void(this.args.input="")):void(this.localLock&&(console.log(this.localLock),this.localLock.pass(e,this)));if(this.history.unshift(e),this.historyCursor=-1,"/"!==e.substring(0,1)){for(this.socket.send(e),this.args.output.push("<< "+e);this.args.output.length>this.max;)this.args.output.shift();return void(this.args.input="")}this.args.output.push(":: "+e),e=e.substring(1);var n=e.split(" ");switch(e=n.shift()){case"pub":for(var r=parseInt(n.shift(),16),i=[];n.length;)i.push(n.shift());var o=new Uint8Array(new Uint16Array([r]).buffer),a=[];for(var u in o)a[u]=o[u];for(var l=0;l<i.length;l++)a[l+2]=parseInt(i[l],16);this.socket.send(new Uint8Array(a));break;case"login":this.args.output.push(":: Escape to cancel"),this.localLock=new _.Login,this.args.prompt="::",this.localLock.init(this),this.args.prompt="::";break;case"register":this.args.output.push(":: Escape to cancel"),this.localLock=new b.Register,this.args.prompt="::",this.localLock.init(this);break;case"auth":this.auth();break;case"clear":for(;this.args.output.length;)this.args.output.pop();break;case"echo":n.length&&(this.localEcho=parseInt(n[0])),this.args.output.push("Echo is "+(this.localEcho?"on":"off"));break;case"cornfield":this.localLock=new y.Cornfield(this),this.args.prompt="::";break;case"image":this.localLock=new m.Image(this,n),this.args.prompt="::";break;case"light":this.args.inverted="inverted";break;case"dark":this.args.inverted="";break;case"file":if(!n.length){this.args.output.push(":: Error: Please supply a channel to publish file.");break}this.fileChannel=n[0],this.tags.file.element.click();break;case"z":this.args.output.push(new g.MeltingText({input:"lmao!"}));break;case"commands":this.args.output.push(JSON.stringify({"/pub":"CHAN BYTES... Publish raw bytes to a channel (hexadecimal)","/auth":"Run the auth procedure.","/login":"Run the login procedure.","/register":"Run the registration procedure.","/clear":"Clear the terminal.","/echo":"[1|0] Enable/Disable/Check localEcho.","/light":"Light theme.","/dark":"Dark theme.","/cornfield":"Play Cornfield."},null,4));break;case"offer":this.peerClientChannel=this.peerClient.createDataChannel("chat"),this.peerClientChannel.addEventListener("open",function(){console.log("Remote peer server accepted!")}),this.peerClientChannel.addEventListener("message",function(e){console.log("Remote peer server sent message!"),console.log(e)}),this.peerClient.createOffer().then(function(e){t.peerClient.setLocalDescription(e)});break;case"answer":if(!n.length){this.args.output.push(":: Error: Please supply SDP offer string.");break}var f=new RTCSessionDescription(JSON.parse(n.join(" ")));this.peerServer.setRemoteDescription(f),this.peerServer.createAnswer(function(e){console.log(e);JSON.stringify(e,null,4);t.peerServer.setLocalDescription(e)},function(e){console.error(e),t.args.output.push(":: Error: Unexpected exception.")});break;case"accept":if(!n.length){this.args.output.push(":: Error: Please supply SDP offer string.");break}var w=new RTCSessionDescription(JSON.parse(n.join(" ")));this.peerClient.setRemoteDescription(w);break;case"connect":this.socket=h.Socket.get(c.Config.socketHost,!0),this.socket.subscribe("close",function(e){console.log("Disconnected!"),t.args.output.push(":: Disconnected!"),t.args.output.push(":: Reinitializing in 5s..."),t.recon?(t.clearTimeout(t.recon),t.recon=!1):t.recon=t.onTimeout(5e3,function(){t.recon=!1,t.runScript("/bounce_rc")})}),this.socket.subscribe("open",function(){t.runScript("/open_rc")}),this.socket.subscribe("message",function(e,n,r,i,o,a,u){if("string"==typeof e.data){var c=JSON.parse(e.data);"object"==("undefined"==typeof c?"undefined":s(c))&&(c=JSON.stringify(c,null,4)),t.localEcho&&t.args.output.push(new v.TextMessageView({message:c}))}else if(e.data instanceof ArrayBuffer){var l=new Uint8Array(e.data),f=o.toString(16).toUpperCase().padStart(4,"0"),h=r.toString(16).toUpperCase().padStart(4,"0"),g="0x"+f+h,_=[o.toString(16).toUpperCase().padStart(4,"0"),r.toString(16).toUpperCase().padStart(4,"0")].join("").match(/.{1,2}/g),b=6;if("server"==i){_=[r.toString(16).padStart(4,"0")],g="0x"+r.toString(16).padStart(4,"0")}var y=Array.from(l).map(function(e){return e.toString(16).toUpperCase().padStart(2,"0")});for(t.localEcho&&t.args.output.push(new p.BinaryMessageView({header:new d.ByteView({separator:"",bytes:_}),message:new d.ByteView({separator:" ",bytes:y.slice(b)})}));t.args.output.length>t.max;)t.args.output.shift()}})}this.args.input=""}},{key:"auth",value:function(){var e=this;return fetch("/auth?api").then(function(e){return e.text()}).then(function(t){return e.args.output.push("<< auth [token censored]"),e.socket.send("auth "+t),!0})}},{key:"test",value:function(e){var t=this;if("Enter"==e.key){var n=this.args.input;this.args.input="",this.onTimeout(0,function(){t.interpret(n)}),console.log(n)}}},{key:"cancel",value:function(e){e.preventDefault(),e.stopPropagation()}}]),r}(l.View)}),require.register("TextMessageView.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.TextMessageView=void 0;var a=t("curvature/base/View");e.TextMessageView=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.template='<span>&gt;&gt;&nbsp;</span><span class = "text">[[message]]</span>',n}return o(t,e),t}(a.View)}),require.register("chat/Chat.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Chat=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("./View.js");e.Chat=function(){function e(t,n){r(this,e),t.args.output.push(new o.View)}return i(e,[{key:"pass",value:function(e){}}]),e}()}),require.register("chat/View.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var a=t("curvature/base/View");e.View=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,n);var o=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return o.template=t("./view.tmp"),o}return o(n,e),n}(a.View)}),require.register("chat/view.tmp.html",function(e,t,n){n.exports='<div class = "nynex window">\n\t<div class = "titlebar">\n\t\t<div class = "title"> Chat App</div>\n\t\t<div class = "button"></div>\n\t\t<div class = "button"></div>\n\t</div>\n\t<select multiple height = "5">\n\t\t<option>Buddy</option>\n\t\t<option>Guy</option>\n\t\t<option>Friend</option>\n\t</select>\n</div>'}),require.register("initialize.js",function(e,t,n){"use strict";var r=(t("curvature/base/Tag"),t("curvature/base/RuleSet")),i=t("curvature/base/Router"),o=t("./RootView"),a=new o.RootView;r.RuleSet.add("body",a),r.RuleSet.wait(),i.Router.wait(a)}),require.register("root.tmp.html",function(e,t,n){n.exports='<div class = "main [[inverted]]" cv-on = "click:focus(event)">\n\t<div class = "top">\n\t\t<div class = "menu"></div>\n\t\t<div class = "terminal">\n\t\t\t<div class = "output" cv-each = "output:line:l" cv-ref = "output:curvature/base/Tag">\n\t\t\t\t<p>[[line]]</p>\n\t\t\t</div>\n\t\t\t<div class = "bottom">\n\t\t\t\t<div>[[prompt]]&nbsp;</div>\n\t\t\t\t<div>\n\n\t\t\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tcv-on        = "keydown:test(event)"\n\t\t\t\t\t\t\tcv-bind      = "input"\n\t\t\t\t\t\t\tautocomplete = "off"\n\t\t\t\t\t\t\tcv-ref       = "input:curvature/base/Tag"/>\n\t\t\t\t\t</form>\n\n\t\t\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname         = "pw-input"\n\t\t\t\t\t\t\ttype         = "password"\n\t\t\t\t\t\t\tcv-on        = "keydown:test(event)"\n\t\t\t\t\t\t\tcv-bind      = "input"\n\t\t\t\t\t\t\tautocomplete = "one-time-code"\n\t\t\t\t\t\t\tcv-ref       = "password:curvature/base/Tag"/>\n\t\t\t\t\t</form>\n\n\t\t\t\t\t<input\n\t\t\t\t\t\tname  = "file-input"\n\t\t\t\t\t\ttype  = "file"\n\t\t\t\t\t\tstyle = "display: none"\n\t\t\t\t\t\tcv-on = "input:fileLoaded(event)"\n\t\t\t\t\t\tcv-ref = "file:curvature/base/Tag"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class = "scanlines"></div>\n</div>\n'}),require.register("___globals___",function(e,t,n){})}(),require("___globals___");